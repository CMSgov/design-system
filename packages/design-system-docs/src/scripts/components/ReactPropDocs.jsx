import {
  Table,
  TableBody,
  TableCaption,
  TableHead,
  TableHeader,
  TableRow,
} from '@cmsgov/design-system';
import PropTypes from 'prop-types';
import React from 'react';
import ReactPropDoc from './ReactPropDoc';

/**
 * Render a table with property documentation (generated by react-docgen)
 */
class ReactPropDocs extends React.PureComponent {
  rows() {
    const props = Object.getOwnPropertyNames(this.props.propDocs);

    return props.map((prop) => {
      // Hides docs for react props with `@hide-prop` tag in the description
      const description = this.props.propDocs[prop].description;
      if (!description.match(/@hide-prop/i)) {
        return <ReactPropDoc key={prop} name={prop} {...this.props.propDocs[prop]} />;
      }
    });
  }

  render() {
    const formattedScrollCaption = <small>Scroll using arrow keys to see more...</small>;

    return [
      <h3 key="propDocsHeader">Props</h3>,
      <Table key="propDocsTable" stacked="sm" scrollTable>
        <TableCaption scrollableCaption={formattedScrollCaption}>
          React Properties Documentation
        </TableCaption>
        <TableHead>
          <TableRow>
            <TableHeader id="columnname" type="text" title="Name" scope="col" />
            <TableHeader id="columntype" type="text" title="Type" scope="col" />
            <TableHeader id="columndefault" type="text" title="Default" scope="col" />
            <TableHeader id="columndescription" type="text" title="Description" scope="col" />
          </TableRow>
        </TableHead>
        <TableBody>{this.rows()}</TableBody>
      </Table>,
    ];
  }
}

ReactPropDocs.propTypes = {
  /* eslint-disable react/forbid-prop-types */
  propDocs: PropTypes.object,
};

export default ReactPropDocs;
