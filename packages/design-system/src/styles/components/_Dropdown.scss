@use '../layout' as *;
@use '../mixins';

// Wraps all label and dropdown markup
.ds-c-dropdown {
  max-width: var(--form__max-width);
  position: relative;
}

// Dropdown uses a <button> to fake a <select> element
// This styles a <button> to look like a <select> and positions content within
.ds-c-dropdown__button.ds-c-field {
  appearance: none;
  background-color: var(--dropdown__background-color);
  display: flex;
  gap: 2ch;
  justify-content: space-between;
  padding-inline-start: var(--spacer-3);
  text-align: start;

  // Removes inner outline on select elements in Firefox.
  &:-moz-focusring {
    color: transparent;
    text-shadow: 0 0 0 #000;
  }
}

// Dropdown previously used a background image for the caret
// Caret is now an SVG icon that is rotated based on aria-expanded set on its parent
// Rotation (and potential animation) couldn't be handled on the background element, but can now that it's its own element
.ds-c-dropdown__caret {
  flex-basis: 0 0 auto;

  [aria-expanded='true'] & {
    transform: rotate(180deg);
  }

  [aria-expanded='false'] & {
    transform: rotate(0deg);
  }
}

// Styles for the dropdown menu
.ds-c-dropdown__menu-container {
  background-color: var(--autocomplete__background-color);
  border: var(--text-input__border-width) solid var(--text-input__border-color);
  border-block-start: none;
  border-end-end-radius: var(--text-input__border-radius);
  border-end-start-radius: var(--text-input__border-radius);
  margin-block-start: calc(-1 * var(--text-input__border-width));
  max-height: 320px;
  overflow-y: auto;
  position: absolute;
  width: 100%;
  z-index: var(--z-dialog);

  .ds-c-field--inverse + & {
    color: var(--color-base);
  }

  // When dropdown is open (not `hidden`), add border radius to bottom of menu
  &:not([hidden]) {
    animation: fade-in var(--animation-speed-1) var(--animation-ease-in-out-expo);
    border-radius: 0 0 var(--dropdown-menu__border-radius--open)
      var(--dropdown-menu__border-radius--open);
    box-shadow: 0 0 17px 0 var(--color-gray-light);
  }
}

.ds-c-dropdown__menu {
  @include mixins.ds-unstyled-list;
  gap: 0;
}

// Animation keyframes for dropdown menu
@keyframes fade-in {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}

// Base styles for grouped and individual dropdown elements
.ds-c-dropdown__item,
.ds-c-dropdown__item-group {
  cursor: default;
  padding: var(--spacer-1) var(--spacer-3);

  &:last-child {
    border-block-end: none;
  }
}

.ds-c-dropdown__item-group {
  font-weight: var(--font-weight-bold);
}

.ds-c-dropdown__menu--grouped .ds-c-dropdown__item {
  padding-inline-start: var(--spacer-5);
}

// Styles for dropdown elements that are highlighted
.ds-c-dropdown__item--highlighted {
  background-color: var(--color-primary-lightest);
  transition: background-color var(--animation-speed-1) var(--animation-ease-in-out-expo);
}

// Styles for dropdown elements that are selected
.ds-c-dropdown__item--selected {
  background-color: var(--color-primary);
  color: var(--color-white);
  font-weight: var(--font-weight-bold);
}

.ds-c-dropdown__item-selected-indicator {
  padding-inline-end: var(--spacer-1);
}
